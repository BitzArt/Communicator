## Advanced Scenarios

### Custom HTTP Message Handlers

**Flux.REST** allows configuring custom [http message handlers](https://learn.microsoft.com/en-us/aspnet/web-api/overview/advanced/http-message-handlers) for your external services. This can be useful for adding custom headers, logging, or any other custom logic.

Example of an http message handler:

```csharp
private class MyHttpHandler : DelegatingHandler
{
    protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
    {
        return base.SendAsync(request, cancellationToken);
    }
}
```

To use a custom http message handler, add it when configuring your external service:

```csharp
services.AddFlux(flux =>
{
    flux.AddService("my-service")
        .UsingRest<MyHttpHandler>("http://external.service.address")
});
```